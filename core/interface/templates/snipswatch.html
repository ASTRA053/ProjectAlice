{% extends 'base.html' %}

{% block header %}
	{% block title %}Snips Watch{% endblock %}
{% endblock %}

{% block content %}
	<script src="{{ url_for('static', filename='jquery-3.4.1.min.js') }}"></script>
	<script type=text/javascript>
		let $SCRIPT_ROOT = {{ request.script_root|tojson|safe }};
		function refreshData(type) {
		    $.get(
				$SCRIPT_ROOT + '/snipswatch/' + type,
                function (data) {
				    let container = $('#console');
                    for (let i = 0; i < data.data.length; i++) {
                        container.append(
                            '<span class="logLine">' + data.data[i] + '</span>'
                        );
                    }
                    container.animate(
                        {
							scrollTop: container[0].scrollHeight - container[0].clientHeight
                    	},
						250
					)
                }
			)
		}
		$(document).ready(
		    function() {
		        refreshData('refresh');
				setInterval(function() {
				    refreshData('update')
				}, 500)
			}
		)
	</script>
	<div class="console" id="console">
	</div>
{% endblock %}